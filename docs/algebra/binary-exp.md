# ორობითი სიძლიერე

ორობითი სიძლიერე (ასევე ცნობილია, როგორც კვადრატული სიმძლავრე) არის ხრიკი, რომელიც საშუალებას გვაძლევს გამოთვალოთ $(a^n)$ მხოლოდ $O(\log n)$ ოპერაციაში (ნაცვლად $O(n)$ ).

მას ასევე აქვს მნიშვნელოვანი როლი არითმეტიკასთან დაკავშირებულ ბევრ ამოცანაში, რადგან ის
შეიძლება გამოყენებულ იქნას ნებისმიერი ოპერაციაში, რომელსაც აქვს თვისება **ასოციაციურობა**:

$$(X \cdot Y) \cdot Z = X \cdot (Y \cdot Z)$$

ყველაზე აშკარად ეს ეხება მოდულურ გამრავლებას, მატრიცების გამრავლებას და სხვა ამოცანებს, რომლებსაც ქვემოთ განვიხილავთ.

## ალგორითმი
$a$-ს აწევა $n$-ის ხარისხზე ჩვეულებრივ გამოიხატება, როგორც $a$-ს გამრავლება $n-1$ ჯერ:
$a^{n} = a \cdot a \cdot \ldots \cdot a$. თუმცა ეს მიდგომა არ არის პრაქტიკული დიდი $a$ ან $n$ თვის.

$a^{b+c} = a^b \cdot a^c$ და $a^{2b} = a^b \cdot a^b = (a^b)^2$.

ორობითი სიძლიერის იდეა არის ის, რომ ჩვენ ვყოფთ სამუშაოს ექსპონენტის ორობითი წარმოდგენის გამოყენებით.

მოდი დავწეროთ $n$-ი 2-ის ფუძით (ორობითში), მაგალითად:

$$3^{13} = 3^{1101_2} = 3^8 \cdot 3^4 \cdot 3^1$$

ნომრიდან გამომდინარე $n$-ს აქვს ზუსტად $\lfloor \log_2 n \rfloor + 1$ ციფრი 2-ის ფუძით, ჩვენ მხოლოდ $O(\log n)$ გამრავლება გვჭირდება, თუ ჩვენ ვიცით ხარისხები $a^1, a^2, a^4, a^8, \dots, a^{2^{\lfloor \log n \rfloor}}$.

ასე რომ, ჩვენ მხოლოდ უნდა ვიცოდეთ მათი გამოთვლის სწრაფი გზა. საბედნიეროდ, ეს ძალიან მარტივია, რადგან ელემენტი თანმიმდევრობით არის მხოლოდ წინა ელემენტის კვადრატი.

$$\begin{align}
3^1 &= 3 \\
3^2 &= \left(3^1\right)^2 = 3^2 = 9 \\
3^4 &= \left(3^2\right)^2 = 9^2 = 81 \\
3^8 &= \left(3^4\right)^2 = 81^2 = 6561
\end{align}$$

ამიტომ საბოლოო პასუხის მისაღებად $3^{13}$, ჩვენ მხოლოდ სამი მათგანი უნდა გავამრავლოთ (გამოვტოვოთ $3^2$ რადგან შესაბამისი ბიტი $n$-ისთვის არის 0):

$3^{13} = 6561 \cdot 81 \cdot 3 = 1594323$

ამ ალგორითმის საბოლოო სირთულე არის $O(\log n)$: ჩვენ უნდა გამოვთვალოთ $\log n$ სიმძლავრეები $a$-ზე და შემდეგ უნდა გავაკეთოთ მაქსიმუმ $\log n$ გამრავლება, რომ მივიღოთ საბოლოო პასუხი.

მოცემული რეკურსიული მიდგომა გამოხატავს იმავე აზრს:

$$a^n = \begin{cases}
1 &\text{if } n == 0 \\
\left(a^{\frac{n}{2}}\right)^2 &\text{if } n > 0 \text{ and } n \text{ even}\\
\left(a^{\frac{n - 1}{2}}\right)^2 \cdot a &\text{if } n > 0 \text{ and } n \text{ odd}\\
\end{cases}$$

## განხორციელება

პირველი რეკურსიული მიდგომა, რომელიც არის რეკურსიული ფორმულის პირდაპირი თარგმანი:

```cpp
long long binpow(long long a, long long b) {
    if (b == 0)
        return 1;
    long long res = binpow(a, b / 2);
    if (b % 2)
        return res * res * a;
    else
        return res * res;
}
```

მეორე მიდგომა ასრულებს იგივე ამოცანას რეკურსიის გარეშე.
ის გამოითვლის ყველა ხარისხს ციკლში და ამრავლებს ერთეულებს შესაბამისი კომპლექტის ბიტით $n$-ში.
მიუხედავად იმისა, რომ ორივე მიდგომის სირთულე იდენტურია, ეს მიდგომა პრაქტიკაში უფრო სწრაფი იქნება, რადგან ჩვენ არ ვიყენებთ რეკურსიულ გამოძახებას რამაც შეიძლება დაამატოს დამატებითი დამუშავების დრო

```cpp
long long binpow(long long a, long long b) {
    long long res = 1;
    while (b > 0) {
        if (b & 1)
            res = res * a;
        a = a * a;
        b >>= 1;
    }
    return res;
}
```

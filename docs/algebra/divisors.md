# გამყოფთა რაოდენობა / გამყოფთა ჯამი

ამ სტატიაში განვიხილავთ, თუ როგორ უნდა გამოვთვალოთ $d(n)$ გამყოფების რაოდენობა და მოცემული $n$-ის $\sigma(n)$ გამყოფების ჯამი.

## გამყოფთა რაოდენობა

აშკარა უნდა იყოს, რომ $d$ გამყოფის ძირითადი ფაქტორიზაცია უნდა იყოს $n$-ის ძირითადი ფაქტორიზაციის ქვესიმრავლე, მაგ. $6 = 2 \cdot 3$ არის $60 = 2^2 \cdot 3 \cdot 5$-ის გამყოფი.
ასე რომ, ჩვენ მხოლოდ უნდა ვიპოვოთ $n$-ის ძირითადი ფაქტორიზაციის ყველა განსხვავებული ქვეჯგუფი.

ჩვეულებრივ ქვეჯგუფების რაოდენობა არის $2^x$ ნაკრებისთვის $x$ ელემენტებით.
თუმცა ეს აღარ არის მართალი, თუ ნაკრებში განმეორებითი ელემენტებია. ჩვენს შემთხვევაში, რამდენიმე ძირითადი ფაქტორი შეიძლება რამდენჯერმე გამოჩნდეს $n$-ის მთავარ ფაქტორიზაციით.

თუ $n$-ის ძირითადი ფაქტორიზაციით $e$-ჯერ გამოჩნდება პირველი ფაქტორი $p$, მაშინ ჩვენ შეგვიძლია გამოვიყენოთ $p$-მდე $e$-ჯერ ქვეჯგუფში.
რაც ნიშნავს, რომ გვაქვს $e+1$ არჩევანი.

ამიტომ, თუ $n$-ის ძირითადი ფაქტორიზაცია არის $p_1^{e_1} \cdot p_2^{e_2} \cdots p_k^{e_k}$, სადაც $p_i$ განსხვავებული მარტივი რიცხვებია, მაშინ გამყოფთა რიცხვი არის:

$$d(n) = (e_1 + 1) \cdot (e_2 + 1) \cdots (e_k + 1)$$

ამაზე აზროვნების გზა შემდეგია:

* თუ არსებობს მხოლოდ ერთი განსხვავებული ძირითადი გამყოფი $n = p_1^{e_1}$, მაშინ აშკარად არის $e_1 + 1$ გამყოფები ($1, p_1, p_1^2, \dots, p_1^{e_1}$).

* თუ არსებობს ორი განსხვავებული ძირითადი გამყოფი $n = p_1^{e_1} \cdot p_2^{e_2}$, მაშინ თქვენ შეგიძლიათ დაალაგოთ ყველა გამყოფი ცხრილის სახით.

$$\begin{array}{c|ccccc}
& 1 & p_2 & p_2^2 & \dots & p_2^{e_2} \\\\\hline
1 & 1 & p_2 & p_2^2 & \dots & p_2^{e_2} \\\\
p_1 & p_1 & p_1 \cdot p_2 & p_1 \cdot p_2^2 & \dots & p_1 \cdot p_2^{e_2} \\\\
p_1^2 & p_1^2 & p_1^2 \cdot p_2 & p_1^2 \cdot p_2^2 & \dots & p_1^2 \cdot p_2^{e_2} \\\\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots \\\\
p_1^{e_1} & p_1^{e_1} & p_1^{e_1} \cdot p_2 & p_1^{e_1} \cdot p_2^2 & \dots & p_1^{e_1} \cdot p_2^{e_2} \\\\
\end{array}$$

ასე რომ, გამყოფთა რაოდენობა ტრივიალურად არის $(e_1 + 1) \cdot (e_2 + 1)$.

* მსგავსი არგუმენტი შეიძლება გაკეთდეს, თუ არსებობს ორზე მეტი განსხვავებული ძირითადი ფაქტორი.

```cpp
long long numberOfDivisors(long long num) {
    long long total = 1;
    for (int i = 2; (long long)i * i <= num; i++) {
        if (num % i == 0) {
            int e = 0;
            do {
                e++;
                num /= i;
            } while (num % i == 0);
            total *= e + 1;
        }
    }
    if (num > 1) {
        total *= 2;
    }
    return total;
}
```

## გამყოფთა ჯამი

ჩვენ შეგვიძლია გამოვიყენოთ წინა ნაწილის იგივე არგუმენტი.

* თუ არსებობს მხოლოდ ერთი განსხვავებული ძირითადი გამყოფი $n = p_1^{e_1}$, მაშინ ჯამი არის:

$$1 + p_1 + p_1^2 + \dots + p_1^{e_1} = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1}$$

* თუ არსებობს ორი განსხვავებული ძირითადი გამყოფი $n = p_1^{e_1} \cdot p_2^{e_2}$, მაშინ ჩვენ შეგვიძლია შევქმნათ იგივე ცხრილი, როგორც ადრე.
  ერთადერთი განსხვავება ისაა, რომ ახლა ჩვენ გვინდა გამოვთვალოთ ჯამი ელემენტების დათვლის ნაცვლად.
  ადვილი მისახვედრია, რომ თითოეული კომბინაციის ჯამი შეიძლება გამოისახოს შემდეგნაირად:

$$\left(1 + p_1 + p_1^2 + \dots + p_1^{e_1}\right) \cdot \left(1 + p_2 + p_2^2 + \dots + p_2^{e_2}\right)$$

$$ = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \cdot \frac{p_2^{e_2 + 1} - 1}{p_2 - 1}$$

* ზოგადად, $n = p_1^{e_1} \cdot p_2^{e_2} \cdots p_k^{e_k}$-სთვის ვიღებთ ფორმულას:

$$\sigma(n) = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \cdot \frac{p_2^{e_2 + 1} - 1}{p_2 - 1} \cdots \frac{p_k^{e_k + 1} - 1}{p_k - 1}$$

```cpp
long long SumOfDivisors(long long num) {
    long long total = 1;

    for (int i = 2; (long long)i * i <= num; i++) {
        if (num % i == 0) {
            int e = 0;
            do {
                e++;
                num /= i;
            } while (num % i == 0);

            long long sum = 0, pow = 1;
            do {
                sum += pow;
                pow *= i;
            } while (e-- > 0);
            total *= sum;
        }
    }
    if (num > 1) {
        total *= (1 + num);
    }
    return total;
}
```

## გამრავლების ფუნქციები

მრავლობითი ფუნქცია არის $f(x)$ ფუნქცია, რომელიც აკმაყოფილებს

$$f(a \cdot b) = f(a) \cdot f(b)$$

თუ $a$ და $b$ არის თანაპრიმი.

ორივე $d(n)$ და $\sigma(n)$ არის მრავლობითი ფუნქციები.

გამრავლების ფუნქციებს აქვთ საინტერესო თვისებების უზარმაზარი მრავალფეროვნება, რაც შეიძლება ძალიან სასარგებლო იყოს რიცხვების თეორიის ამოცანებში.
მაგალითად, ორი მამრავლებელი ფუნქციის დირიხლეს კონვოლუცია ასევე მრავლობითია.

## Practice Problems

  - [SPOJ - COMDIV](https://www.spoj.com/problems/COMDIV/)
  - [SPOJ - DIVSUM](https://www.spoj.com/problems/DIVSUM/)
  - [SPOJ - DIVSUM2](https://www.spoj.com/problems/DIVSUM2/)
